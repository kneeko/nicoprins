!function(){function a(){var a=$(".content");a.find("a[data-section]").click(function(a){var e=$(this);a.preventDefault();var n=e.attr("data-section");$("nav a.active").removeClass("active"),$('nav a[data-section="'+n+'"]').addClass("active");var i=e.attr("href"),c=e.attr("title");t(i,c)})}function t(e){var n=$(".content"),i=(n.attr("data-view"),"/fragment"+e),c=$(".spinner");n.attr("data-view",e);var v,o="/work"!=e?e:"/",r=Date.now(),s=!0,l=!1,d=!1,f=315,u=function(){l=!0;var a=Date.now()-r;a>f&&(n.removeClass("loading"),c.removeClass("active")),o!=location.pathname&&history.pushState(null,null,o)};window.setTimeout(function(){l||(n.addClass("loading"),c.addClass("active"))},f);var m=function(a){v=$(a),h(v)},h=function(e){d||(e.find("img").each(function(){new RetinaImage(this)}),e.find("a:not(.external)").click(function(a){var e=$(this);a.preventDefault();var n=e.attr("data-section");$("nav a.active").removeClass("active"),$('nav a[data-section="'+n+'"]').addClass("active");var i=e.attr("href"),c=e.attr("title");t(i,c)}),n.html(e),a())};s&&$.ajax({url:i,type:"GET",dataType:"html",success:m,complete:u})}$("nav a[data-section]").click(function(a){var e=$(this);a.preventDefault(),$("a.active").removeClass("active");var n=e.attr("data-section");$("nav a.active").removeClass("active"),$('nav a[data-section="'+n+'"]').addClass("active");var i=e.attr("href"),c=e.attr("title");t(i,c)}),window.addEventListener("popstate",function(){t(location.pathname)}),a()}();